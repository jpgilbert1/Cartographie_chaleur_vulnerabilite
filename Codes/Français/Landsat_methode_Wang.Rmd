---
title: "Sélection_image_Landsat"
author: "Département "
date: "25/05/2022"
output: html_document
---

## Choix des images Landsat
Rappelons que la méthode de calcul de la température du sol est: An Efficient Framework for Producing Landsat-Based Land Surface Temperature Data Using Google Earth Engine. Les détails de la méthode se retrouve dans l'article scientifique. Le code pour le téléchargement des images se retrouve ici : https://code.earthengine.google.com/?accept_repo=users/wangmmcug/landsat_psc_lst

Il est important d'avoir un compte Google Earth Engine, sinon il ne sera pas possible d'avoir accès aux images.
```{r eval=FALSE}
library(rgee)
ee_Initialize()
```

```{r eval=FALSE}
extraction_date <- function(df)
{#' extraction_date
#'
#' @param df 
#'extrait les dates de la colonne date et les met danss leur propre colone
#'
#' @return df avec trois nouveaux champs, Year, month et day
#' @export
#'
#' @examples
  
  df$Year <- as.numeric(substr(df$Date, start = 1, stop = 4))
  df$Month <- as.numeric(substr(df$Date, start = 6, stop = 7))
  df$Day <- as.numeric(substr(df$Date, start = 9, stop = 10))
  return(df)
}
```

#Terre-Neuve et Labrador
```{r eval=FALSE}
region_TNL <- ee$Geometry$BBox(-59.93, 47.00, -50.46, 51.25)
image_TNL_2018 <- ee$ImageCollection("LANDSAT/LC08/C02/T1")$filterDate('2018-05-01', '2018-08-31')$filterBounds(region_TNL)
image_TNL_2019 <- ee$ImageCollection("LANDSAT/LC08/C02/T1")$filterDate('2019-05-01', '2019-08-31')$filterBounds(region_TNL)
image_TNL_2020 <- ee$ImageCollection("LANDSAT/LC08/C02/T1")$filterDate('2020-05-01', '2020-08-31')$filterBounds(region_TNL)

image_TNL_2018 <- image_TNL_2018$getInfo()
image_TNL_2018_df <- data.frame(1, c(1:length(image_TNL_2018$features)))
image_TNL_2018_df$Date <- 1
image_TNL_2018_df$Row <- 1
image_TNL_2018_df$Path <- 1

image_TNL_2019 <- image_TNL_2019$getInfo()
image_TNL_2019_df <- data.frame(1, c(1:length(image_TNL_2019$features)))
image_TNL_2019_df$Date <- 1
image_TNL_2019_df$Row <- 1
image_TNL_2019_df$Path <- 1

image_TNL_2020 <- image_TNL_2020$getInfo()
image_TNL_2020_df <- data.frame(1, c(1:length(image_TNL_2020$features)))
image_TNL_2020_df$Date <- 1
image_TNL_2020_df$Row <- 1
image_TNL_2020_df$Path <- 1

for (i in 1:length(image_TNL_2018$features))
{
  image_TNL_2018_df$Date[i] <- image_TNL_2018$features[i][[1]]$properties$DATE_ACQUIRED
  image_TNL_2018_df$Row[i] <- image_TNL_2018$features[i][[1]]$properties$TARGET_WRS_ROW
  image_TNL_2018_df$Path[i] <- image_TNL_2018$features[i][[1]]$properties$TARGET_WRS_PATH
}

for (i in 1:length(image_TNL_2019$features))
{
  image_TNL_2019_df$Date[i] <- image_TNL_2019$features[i][[1]]$properties$DATE_ACQUIRED
  image_TNL_2019_df$Row[i] <- image_TNL_2019$features[i][[1]]$properties$TARGET_WRS_ROW
  image_TNL_2019_df$Path[i] <- image_TNL_2019$features[i][[1]]$properties$TARGET_WRS_PATH
}

for (i in 1:length(image_TNL_2020$features))
{
  image_TNL_2020_df$Date[i] <- image_TNL_2020$features[i][[1]]$properties$DATE_ACQUIRED
  image_TNL_2020_df$Row[i] <- image_TNL_2020$features[i][[1]]$properties$TARGET_WRS_ROW
  image_TNL_2020_df$Path[i] <- image_TNL_2020$features[i][[1]]$properties$TARGET_WRS_PATH
}

image_TNL_2018_df <- extraction_date(image_TNL_2018_df)
image_TNL_2019_df <- extraction_date(image_TNL_2019_df)
image_TNL_2020_df <- extraction_date(image_TNL_2020_df)

image_TNL_2018_df <- image_TNL_2018_df[,c(-1:-2)]
image_TNL_2019_df <- image_TNL_2019_df[,c(-1:-2)]
image_TNL_2020_df <- image_TNL_2020_df[,c(-1:-2)]

#combine les fichiers ensemble
Image_dispo_TNL <- do.call('rbind', list(image_TNL_2018_df,image_TNL_2019_df,image_TNL_2020_df))
Image_journee_chaude_TNL <- Image_dispo_TNL[1,]

#va cherche le fichier qui est les journees chaudes, soit 30 celsius ou plus comme t maximal dans la journee
donnee_meteo <- read.csv2("FICHIER_JOURNÉES_CHAUDES", sep=",")
donnee_station <- read.csv2("CHEMIN_DU_FICHIER\\Station Inventory EN_2.csv", sep = ",")
donnee_meteo_2 <- merge(donnee_meteo, donnee_station, by.x = "ID.climatologique", by.y = "Climate.ID")
TN <- donnee_meteo_2[which(donnee_meteo_2$Province == "NEWFOUNDLAND"),]

#Dans le lot d'images, pas toutes les images correspondent a des journees chaudes, donc on ne les telecharges pas pour rien
for (i in 1:nrow(Image_dispo_TNL))
{
 for (j in 1:nrow(TN))
 {
   if(as.character(Image_dispo_TNL$Date[i]) == TN$Date.Heure[j])
   {
     Image_journee_chaude_TNL <- rbind(Image_journee_chaude_TNL, Image_dispo_TNL[i,])
   }
 }
  print(i)
}

Image_journee_chaude_TNL <- Image_journee_chaude_TNL[-1,]
write.csv(Image_journee_chaude_TNL, "CHEMIN_FICHIER_CONTENANT_LES_INFORMATIONS_NÉCESSAIRES_AU_TÉLÉCHARGEMENT")
```

#Ontario sud
```{r eval=FALSE}
region_ont_sud <- ee$Geometry$BBox(-83.90, 41.92, -75.46, 45.81)
image_ont_sud_2018 <- ee$ImageCollection("LANDSAT/LC08/C02/T1")$filterDate('2018-05-01', '2018-08-31')$filterBounds(region_ont_sud)
image_ont_sud_2019 <- ee$ImageCollection("LANDSAT/LC08/C02/T1")$filterDate('2019-05-01', '2019-08-31')$filterBounds(region_ont_sud)
image_ont_sud_2020 <- ee$ImageCollection("LANDSAT/LC08/C02/T1")$filterDate('2020-05-01', '2020-08-31')$filterBounds(region_ont_sud)

image_ont_sud_2018 <- image_ont_sud_2018$getInfo()
image_ont_sud_2018_df <- data.frame(1, c(1:length(image_ont_sud_2018$features)))
image_ont_sud_2018_df$Date <- 1
image_ont_sud_2018_df$Row <- 1
image_ont_sud_2018_df$Path <- 1

image_ont_sud_2019 <- image_ont_sud_2019$getInfo()
image_ont_sud_2019_df <- data.frame(1, c(1:length(image_ont_sud_2019$features)))
image_ont_sud_2019_df$Date <- 1
image_ont_sud_2019_df$Row <- 1
image_ont_sud_2019_df$Path <- 1

image_ont_sud_2020 <- image_ont_sud_2020$getInfo()
image_ont_sud_2020_df <- data.frame(1, c(1:length(image_ont_sud_2020$features)))
image_ont_sud_2020_df$Date <- 1
image_ont_sud_2020_df$Row <- 1
image_ont_sud_2020_df$Path <- 1

for (i in 1:length(image_ont_sud_2018$features))
{
  image_ont_sud_2018_df$Date[i] <- image_ont_sud_2018$features[i][[1]]$properties$DATE_ACQUIRED
  image_ont_sud_2018_df$Row[i] <- image_ont_sud_2018$features[i][[1]]$properties$TARGET_WRS_ROW
  image_ont_sud_2018_df$Path[i] <- image_ont_sud_2018$features[i][[1]]$properties$TARGET_WRS_PATH
}

for (i in 1:length(image_ont_sud_2019$features))
{
  image_ont_sud_2019_df$Date[i] <- image_ont_sud_2019$features[i][[1]]$properties$DATE_ACQUIRED
  image_ont_sud_2019_df$Row[i] <- image_ont_sud_2019$features[i][[1]]$properties$TARGET_WRS_ROW
  image_ont_sud_2019_df$Path[i] <- image_ont_sud_2019$features[i][[1]]$properties$TARGET_WRS_PATH
}

for (i in 1:length(image_ont_sud_2020$features))
{
  image_ont_sud_2020_df$Date[i] <- image_ont_sud_2020$features[i][[1]]$properties$DATE_ACQUIRED
  image_ont_sud_2020_df$Row[i] <- image_ont_sud_2020$features[i][[1]]$properties$TARGET_WRS_ROW
  image_ont_sud_2020_df$Path[i] <- image_ont_sud_2020$features[i][[1]]$properties$TARGET_WRS_PATH
}

image_ont_sud_2018_df <- extraction_date(image_ont_sud_2018_df)
image_ont_sud_2019_df <- extraction_date(image_ont_sud_2019_df)
image_ont_sud_2020_df <- extraction_date(image_ont_sud_2020_df)

image_ont_sud_2018_df <- image_ont_sud_2018_df[,c(-1:-2)]
image_ont_sud_2019_df <- image_ont_sud_2019_df[,c(-1:-2)]
image_ont_sud_2020_df <- image_ont_sud_2020_df[,c(-1:-2)]

#combine les fichiers ensemble
Image_dispo_ont_sud <- do.call('rbind', list(image_ont_sud_2018_df,image_ont_sud_2019_df,image_ont_sud_2020_df))
Image_journee_chaude_ont_sud <- Image_dispo_ont_sud[1,]

#va cherche le fichier qui est les journees chaudes, soit 30 celsius ou plus comme t maximal dans la journee
donnee_meteo <- read.csv2("FICHIER_JOURNÉES_CHAUDES", sep=",")
donnee_station <- read.csv2("CHEMIN_DU_FICHIER\\Station Inventory EN_2.csv", sep = ",")
donnee_meteo_2 <- merge(donnee_meteo, donnee_station, by.x = "ID.climatologique", by.y = "Climate.ID")
Ont <- donnee_meteo_2[which(donnee_meteo_2$Province == "ONTARIO"),]

#Dans le lot d'images, pas toutes les images correspondent a des journees chaudes, donc on ne les telecharges pas pour rien
for (i in 1:nrow(Image_dispo_ont_sud))
{
  for (j in 1:nrow(Ont))
  {
    if(as.character(Image_dispo_ont_sud$Date[i]) == Ont$Date.Heure[j])
    {
      Image_journee_chaude_ont_sud <- rbind(Image_journee_chaude_ont_sud, Image_dispo_ont_sud[i,])
    }
  }
  print(i)
}

Image_journee_chaude_ont_sud <- Image_journee_chaude_ont_sud[-1,]
write.csv(Image_journee_chaude_ont_sud, "CHEMIN_FICHIER_CONTENANT_LES_INFORMATIONS_NÉCESSAIRES_AU_TÉLÉCHARGEMENT")
```

#Ontario milieu
```{r eval=FALSE}
region_ont_milieu <- ee$Geometry$BBox(-84.90, 46.00, -78.16, 48.9)
image_ont_milieu_2018 <- ee$ImageCollection("LANDSAT/LC08/C02/T1")$filterDate('2018-05-01', '2018-08-31')$filterBounds(region_ont_milieu)
image_ont_milieu_2019 <- ee$ImageCollection("LANDSAT/LC08/C02/T1")$filterDate('2019-05-01', '2019-08-31')$filterBounds(region_ont_milieu)
image_ont_milieu_2020 <- ee$ImageCollection("LANDSAT/LC08/C02/T1")$filterDate('2020-05-01', '2020-08-31')$filterBounds(region_ont_milieu)

image_ont_milieu_2018 <- image_ont_milieu_2018$getInfo()
image_ont_milieu_2018_df <- data.frame(1, c(1:length(image_ont_milieu_2018$features)))
image_ont_milieu_2018_df$Date <- 1
image_ont_milieu_2018_df$Row <- 1
image_ont_milieu_2018_df$Path <- 1

image_ont_milieu_2019 <- image_ont_milieu_2019$getInfo()
image_ont_milieu_2019_df <- data.frame(1, c(1:length(image_ont_milieu_2019$features)))
image_ont_milieu_2019_df$Date <- 1
image_ont_milieu_2019_df$Row <- 1
image_ont_milieu_2019_df$Path <- 1

image_ont_milieu_2020 <- image_ont_milieu_2020$getInfo()
image_ont_milieu_2020_df <- data.frame(1, c(1:length(image_ont_milieu_2020$features)))
image_ont_milieu_2020_df$Date <- 1
image_ont_milieu_2020_df$Row <- 1
image_ont_milieu_2020_df$Path <- 1

for (i in 1:length(image_ont_milieu_2018$features))
{
  image_ont_milieu_2018_df$Date[i] <- image_ont_milieu_2018$features[i][[1]]$properties$DATE_ACQUIRED
  image_ont_milieu_2018_df$Row[i] <- image_ont_milieu_2018$features[i][[1]]$properties$TARGET_WRS_ROW
  image_ont_milieu_2018_df$Path[i] <- image_ont_milieu_2018$features[i][[1]]$properties$TARGET_WRS_PATH
}

for (i in 1:length(image_ont_milieu_2019$features))
{
  image_ont_milieu_2019_df$Date[i] <- image_ont_milieu_2019$features[i][[1]]$properties$DATE_ACQUIRED
  image_ont_milieu_2019_df$Row[i] <- image_ont_milieu_2019$features[i][[1]]$properties$TARGET_WRS_ROW
  image_ont_milieu_2019_df$Path[i] <- image_ont_milieu_2019$features[i][[1]]$properties$TARGET_WRS_PATH
}

for (i in 1:length(image_ont_milieu_2020$features))
{
  image_ont_milieu_2020_df$Date[i] <- image_ont_milieu_2020$features[i][[1]]$properties$DATE_ACQUIRED
  image_ont_milieu_2020_df$Row[i] <- image_ont_milieu_2020$features[i][[1]]$properties$TARGET_WRS_ROW
  image_ont_milieu_2020_df$Path[i] <- image_ont_milieu_2020$features[i][[1]]$properties$TARGET_WRS_PATH
}

image_ont_milieu_2018_df <- extraction_date(image_ont_milieu_2018_df)
image_ont_milieu_2019_df <- extraction_date(image_ont_milieu_2019_df)
image_ont_milieu_2020_df <- extraction_date(image_ont_milieu_2020_df)

image_ont_milieu_2018_df <- image_ont_milieu_2018_df[,c(-1:-2)]
image_ont_milieu_2019_df <- image_ont_milieu_2019_df[,c(-1:-2)]
image_ont_milieu_2020_df <- image_ont_milieu_2020_df[,c(-1:-2)]

#combine les fichiers ensemble
Image_dispo_ont_milieu <- do.call('rbind', list(image_ont_milieu_2018_df,image_ont_milieu_2019_df,image_ont_milieu_2020_df))
Image_journee_chaude_ont_milieu <- Image_dispo_ont_milieu[1,]

#va cherche le fichier qui est les journees chaudes, soit 30 celsius ou plus comme t maximal dans la journee
donnee_meteo <- read.csv2("FICHIER_JOURNÉES_CHAUDES", sep=",")
donnee_station <- read.csv2("CHEMIN_DU_FICHIER\\Station Inventory EN_2.csv", sep = ",")
donnee_meteo_2 <- merge(donnee_meteo, donnee_station, by.x = "ID.climatologique", by.y = "Climate.ID")
Ont <- donnee_meteo_2[which(donnee_meteo_2$Province == "ONTARIO"),]

#Dans le lot d'images, pas toutes les images correspondent a des journees chaudes, donc on ne les telecharges pas pour rien
for (i in 1:nrow(Image_dispo_ont_milieu))
{
  for (j in 1:nrow(Ont))
  {
    if(as.character(Image_dispo_ont_milieu$Date[i]) == Ont$Date.Heure[j])
    {
      Image_journee_chaude_ont_milieu <- rbind(Image_journee_chaude_ont_milieu, Image_dispo_ont_milieu[i,])
    }
  }
  print(i)
}

Image_journee_chaude_ont_milieu <- Image_journee_chaude_ont_milieu[-1,]
write.csv(Image_journee_chaude_ont_milieu, "CHEMIN_FICHIER_CONTENANT_LES_INFORMATIONS_NÉCESSAIRES_AU_TÉLÉCHARGEMENT")
```

#Ontario ouest
```{r eval=FALSE}
region_ont_ouest <- ee$Geometry$BBox(-95.26, 47.86, -88.29, 49.88)
image_ont_ouest_2018 <- ee$ImageCollection("LANDSAT/LC08/C02/T1")$filterDate('2018-05-01', '2018-08-31')$filterBounds(region_ont_ouest)
image_ont_ouest_2019 <- ee$ImageCollection("LANDSAT/LC08/C02/T1")$filterDate('2019-05-01', '2019-08-31')$filterBounds(region_ont_ouest)
image_ont_ouest_2020 <- ee$ImageCollection("LANDSAT/LC08/C02/T1")$filterDate('2020-05-01', '2020-08-31')$filterBounds(region_ont_ouest)

image_ont_ouest_2018 <- image_ont_ouest_2018$getInfo()
image_ont_ouest_2018_df <- data.frame(1, c(1:length(image_ont_ouest_2018$features)))
image_ont_ouest_2018_df$Date <- 1
image_ont_ouest_2018_df$Row <- 1
image_ont_ouest_2018_df$Path <- 1

image_ont_ouest_2019 <- image_ont_ouest_2019$getInfo()
image_ont_ouest_2019_df <- data.frame(1, c(1:length(image_ont_ouest_2019$features)))
image_ont_ouest_2019_df$Date <- 1
image_ont_ouest_2019_df$Row <- 1
image_ont_ouest_2019_df$Path <- 1

image_ont_ouest_2020 <- image_ont_ouest_2020$getInfo()
image_ont_ouest_2020_df <- data.frame(1, c(1:length(image_ont_ouest_2020$features)))
image_ont_ouest_2020_df$Date <- 1
image_ont_ouest_2020_df$Row <- 1
image_ont_ouest_2020_df$Path <- 1

for (i in 1:length(image_ont_ouest_2018$features))
{
  image_ont_ouest_2018_df$Date[i] <- image_ont_ouest_2018$features[i][[1]]$properties$DATE_ACQUIRED
  image_ont_ouest_2018_df$Row[i] <- image_ont_ouest_2018$features[i][[1]]$properties$TARGET_WRS_ROW
  image_ont_ouest_2018_df$Path[i] <- image_ont_ouest_2018$features[i][[1]]$properties$TARGET_WRS_PATH
}

for (i in 1:length(image_ont_ouest_2019$features))
{
  image_ont_ouest_2019_df$Date[i] <- image_ont_ouest_2019$features[i][[1]]$properties$DATE_ACQUIRED
  image_ont_ouest_2019_df$Row[i] <- image_ont_ouest_2019$features[i][[1]]$properties$TARGET_WRS_ROW
  image_ont_ouest_2019_df$Path[i] <- image_ont_ouest_2019$features[i][[1]]$properties$TARGET_WRS_PATH
}

for (i in 1:length(image_ont_ouest_2020$features))
{
  image_ont_ouest_2020_df$Date[i] <- image_ont_ouest_2020$features[i][[1]]$properties$DATE_ACQUIRED
  image_ont_ouest_2020_df$Row[i] <- image_ont_ouest_2020$features[i][[1]]$properties$TARGET_WRS_ROW
  image_ont_ouest_2020_df$Path[i] <- image_ont_ouest_2020$features[i][[1]]$properties$TARGET_WRS_PATH
}

image_ont_ouest_2018_df <- extraction_date(image_ont_ouest_2018_df)
image_ont_ouest_2019_df <- extraction_date(image_ont_ouest_2019_df)
image_ont_ouest_2020_df <- extraction_date(image_ont_ouest_2020_df)

image_ont_ouest_2018_df <- image_ont_ouest_2018_df[,c(-1:-2)]
image_ont_ouest_2019_df <- image_ont_ouest_2019_df[,c(-1:-2)]
image_ont_ouest_2020_df <- image_ont_ouest_2020_df[,c(-1:-2)]


#combine les fichiers ensemble
Image_dispo_ont_ouest <- do.call('rbind', list(image_ont_ouest_2018_df,image_ont_ouest_2019_df,image_ont_ouest_2020_df))
Image_journee_chaude_ont_ouest <- Image_dispo_ont_ouest[1,]

#va cherche le fichier qui est les journees chaudes, soit 30 celsius ou plus comme t maximal dans la journee
donnee_meteo <- read.csv2("FICHIER_JOURNÉES_CHAUDES", sep=",")
donnee_station <- read.csv2("CHEMIN_DU_FICHIER\\Station Inventory EN_2.csv", sep = ",")
donnee_meteo_2 <- merge(donnee_meteo, donnee_station, by.x = "ID.climatologique", by.y = "Climate.ID")
Ont <- donnee_meteo_2[which(donnee_meteo_2$Province == "ONTARIO"),]

#Dans le lot d'images, pas toutes les images correspondent a des journees chaudes, donc on ne les telecharges pas pour rien
for (i in 1:nrow(Image_dispo_ont_ouest))
{
  for (j in 1:nrow(Ont))
  {
    if(as.character(Image_dispo_ont_ouest$Date[i]) == Ont$Date.Heure[j])
    {
      Image_journee_chaude_ont_ouest <- rbind(Image_journee_chaude_ont_ouest, Image_dispo_ont_ouest[i,])
    }
  }
  print(i)
}

Image_journee_chaude_ont_ouest <- Image_journee_chaude_ont_ouest[-1,]
write.csv(Image_journee_chaude_ont_ouest, "CHEMIN_FICHIER_CONTENANT_LES_INFORMATIONS_NÉCESSAIRES_AU_TÉLÉCHARGEMENT")
```

#Manitoba sud
```{r eval=FALSE}
region_manitoba_sud <- ee$Geometry$BBox(-101.41, 48.99, -96.09, 50.80)
image_manitoba_sud_2018 <- ee$ImageCollection("LANDSAT/LC08/C02/T1")$filterDate('2018-05-01', '2018-08-31')$filterBounds(region_manitoba_sud)
image_manitoba_sud_2019 <- ee$ImageCollection("LANDSAT/LC08/C02/T1")$filterDate('2019-05-01', '2019-08-31')$filterBounds(region_manitoba_sud)
image_manitoba_sud_2020 <- ee$ImageCollection("LANDSAT/LC08/C02/T1")$filterDate('2020-05-01', '2020-08-31')$filterBounds(region_manitoba_sud)

image_manitoba_sud_2018 <- image_manitoba_sud_2018$getInfo()
image_manitoba_sud_2018_df <- data.frame(1, c(1:length(image_manitoba_sud_2018$features)))
image_manitoba_sud_2018_df$Date <- 1
image_manitoba_sud_2018_df$Row <- 1
image_manitoba_sud_2018_df$Path <- 1

image_manitoba_sud_2019 <- image_manitoba_sud_2019$getInfo()
image_manitoba_sud_2019_df <- data.frame(1, c(1:length(image_manitoba_sud_2019$features)))
image_manitoba_sud_2019_df$Date <- 1
image_manitoba_sud_2019_df$Row <- 1
image_manitoba_sud_2019_df$Path <- 1

image_manitoba_sud_2020 <- image_manitoba_sud_2020$getInfo()
image_manitoba_sud_2020_df <- data.frame(1, c(1:length(image_manitoba_sud_2020$features)))
image_manitoba_sud_2020_df$Date <- 1
image_manitoba_sud_2020_df$Row <- 1
image_manitoba_sud_2020_df$Path <- 1

for (i in 1:length(image_manitoba_sud_2018$features))
{
  image_manitoba_sud_2018_df$Date[i] <- image_manitoba_sud_2018$features[i][[1]]$properties$DATE_ACQUIRED
  image_manitoba_sud_2018_df$Row[i] <- image_manitoba_sud_2018$features[i][[1]]$properties$TARGET_WRS_ROW
  image_manitoba_sud_2018_df$Path[i] <- image_manitoba_sud_2018$features[i][[1]]$properties$TARGET_WRS_PATH
}

for (i in 1:length(image_manitoba_sud_2019$features))
{
  image_manitoba_sud_2019_df$Date[i] <- image_manitoba_sud_2019$features[i][[1]]$properties$DATE_ACQUIRED
  image_manitoba_sud_2019_df$Row[i] <- image_manitoba_sud_2019$features[i][[1]]$properties$TARGET_WRS_ROW
  image_manitoba_sud_2019_df$Path[i] <- image_manitoba_sud_2019$features[i][[1]]$properties$TARGET_WRS_PATH
}

for (i in 1:length(image_manitoba_sud_2020$features))
{
  image_manitoba_sud_2020_df$Date[i] <- image_manitoba_sud_2020$features[i][[1]]$properties$DATE_ACQUIRED
  image_manitoba_sud_2020_df$Row[i] <- image_manitoba_sud_2020$features[i][[1]]$properties$TARGET_WRS_ROW
  image_manitoba_sud_2020_df$Path[i] <- image_manitoba_sud_2020$features[i][[1]]$properties$TARGET_WRS_PATH
}

image_manitoba_sud_2018_df <- extraction_date(image_manitoba_sud_2018_df)
image_manitoba_sud_2019_df <- extraction_date(image_manitoba_sud_2019_df)
image_manitoba_sud_2020_df <- extraction_date(image_manitoba_sud_2020_df)

image_manitoba_sud_2018_df <- image_manitoba_sud_2018_df[,c(-1:-2)]
image_manitoba_sud_2019_df <- image_manitoba_sud_2019_df[,c(-1:-2)]
image_manitoba_sud_2020_df <- image_manitoba_sud_2020_df[,c(-1:-2)]

#combine les fichiers ensemble
Image_dispo_manitoba_sud <- do.call('rbind', list(image_manitoba_sud_2018_df,image_manitoba_sud_2019_df,image_manitoba_sud_2020_df))
Image_journee_chaude_manitoba_sud <- Image_dispo_manitoba_sud[1,]

#va cherche le fichier qui est les journees chaudes, soit 30 celsius ou plus comme t maximal dans la journee
donnee_meteo <- read.csv2("FICHIER_JOURNÉES_CHAUDES", sep=",")
donnee_station <- read.csv2("CHEMIN_DU_FICHIER\\Station Inventory EN_2.csv", sep = ",")
donnee_meteo_2 <- merge(donnee_meteo, donnee_station, by.x = "ID.climatologique", by.y = "Climate.ID")
Ont <- donnee_meteo_2[which(donnee_meteo_2$Province == "MANITOBA"),]

#Dans le lot d'images, pas toutes les images correspondent a des journees chaudes, donc on ne les telecharges pas pour rien
for (i in 1:nrow(Image_dispo_manitoba_sud))
{
  for (j in 1:nrow(Ont))
  {
    if(as.character(Image_dispo_manitoba_sud$Date[i]) == Ont$Date.Heure[j])
    {
      Image_journee_chaude_manitoba_sud <- rbind(Image_journee_chaude_manitoba_sud, Image_dispo_manitoba_sud[i,])
    }
  }
  print(i)
}

Image_journee_chaude_manitoba_sud <- Image_journee_chaude_manitoba_sud[-1,]
write.csv(Image_journee_chaude_manitoba_sud, "CHEMIN_FICHIER_CONTENANT_LES_INFORMATIONS_NÉCESSAIRES_AU_TÉLÉCHARGEMENT")
```

#Manitoba nord
```{r eval=FALSE}
region_manitoba_nord <- ee$Geometry$BBox(-98.01, 55.67, -97.67, 55.86)
image_manitoba_nord_2018 <- ee$ImageCollection("LANDSAT/LC08/C02/T1")$filterDate('2018-05-01', '2018-08-31')$filterBounds(region_manitoba_nord)
image_manitoba_nord_2019 <- ee$ImageCollection("LANDSAT/LC08/C02/T1")$filterDate('2019-05-01', '2019-08-31')$filterBounds(region_manitoba_nord)
image_manitoba_nord_2020 <- ee$ImageCollection("LANDSAT/LC08/C02/T1")$filterDate('2020-05-01', '2020-08-31')$filterBounds(region_manitoba_nord)

image_manitoba_nord_2018 <- image_manitoba_nord_2018$getInfo()
image_manitoba_nord_2018_df <- data.frame(1, c(1:length(image_manitoba_nord_2018$features)))
image_manitoba_nord_2018_df$Date <- 1
image_manitoba_nord_2018_df$Row <- 1
image_manitoba_nord_2018_df$Path <- 1

image_manitoba_nord_2019 <- image_manitoba_nord_2019$getInfo()
image_manitoba_nord_2019_df <- data.frame(1, c(1:length(image_manitoba_nord_2019$features)))
image_manitoba_nord_2019_df$Date <- 1
image_manitoba_nord_2019_df$Row <- 1
image_manitoba_nord_2019_df$Path <- 1

image_manitoba_nord_2020 <- image_manitoba_nord_2020$getInfo()
image_manitoba_nord_2020_df <- data.frame(1, c(1:length(image_manitoba_nord_2020$features)))
image_manitoba_nord_2020_df$Date <- 1
image_manitoba_nord_2020_df$Row <- 1
image_manitoba_nord_2020_df$Path <- 1

for (i in 1:length(image_manitoba_nord_2018$features))
{
  image_manitoba_nord_2018_df$Date[i] <- image_manitoba_nord_2018$features[i][[1]]$properties$DATE_ACQUIRED
  image_manitoba_nord_2018_df$Row[i] <- image_manitoba_nord_2018$features[i][[1]]$properties$TARGET_WRS_ROW
  image_manitoba_nord_2018_df$Path[i] <- image_manitoba_nord_2018$features[i][[1]]$properties$TARGET_WRS_PATH
}

for (i in 1:length(image_manitoba_nord_2019$features))
{
  image_manitoba_nord_2019_df$Date[i] <- image_manitoba_nord_2019$features[i][[1]]$properties$DATE_ACQUIRED
  image_manitoba_nord_2019_df$Row[i] <- image_manitoba_nord_2019$features[i][[1]]$properties$TARGET_WRS_ROW
  image_manitoba_nord_2019_df$Path[i] <- image_manitoba_nord_2019$features[i][[1]]$properties$TARGET_WRS_PATH
}

for (i in 1:length(image_manitoba_nord_2020$features))
{
  image_manitoba_nord_2020_df$Date[i] <- image_manitoba_nord_2020$features[i][[1]]$properties$DATE_ACQUIRED
  image_manitoba_nord_2020_df$Row[i] <- image_manitoba_nord_2020$features[i][[1]]$properties$TARGET_WRS_ROW
  image_manitoba_nord_2020_df$Path[i] <- image_manitoba_nord_2020$features[i][[1]]$properties$TARGET_WRS_PATH
}

image_manitoba_nord_2018_df <- extraction_date(image_manitoba_nord_2018_df)
image_manitoba_nord_2019_df <- extraction_date(image_manitoba_nord_2019_df)
image_manitoba_nord_2020_df <- extraction_date(image_manitoba_nord_2020_df)

image_manitoba_nord_2018_df <- image_manitoba_nord_2018_df[,c(-1:-2)]
image_manitoba_nord_2019_df <- image_manitoba_nord_2019_df[,c(-1:-2)]
image_manitoba_nord_2020_df <- image_manitoba_nord_2020_df[,c(-1:-2)]

#combine les fichiers ensemble
Image_dispo_manitoba_nord <- do.call('rbind', list(image_manitoba_nord_2018_df,image_manitoba_nord_2019_df,image_manitoba_nord_2020_df))
Image_journee_chaude_manitoba_nord <- Image_dispo_manitoba_nord[1,]

#va cherche le fichier qui est les journees chaudes, soit 30 celsius ou plus comme t maximal dans la journee
donnee_meteo <- read.csv2("FICHIER_JOURNÉES_CHAUDES", sep=",")
donnee_station <- read.csv2("CHEMIN_DU_FICHIER\\Station Inventory EN_2.csv", sep = ",")
donnee_meteo_2 <- merge(donnee_meteo, donnee_station, by.x = "ID.climatologique", by.y = "Climate.ID")
Ont <- donnee_meteo_2[which(donnee_meteo_2$Province == "MANITOBA"),]

#Dans le lot d'images, pas toutes les images correspondent a des journees chaudes, donc on ne les telecharges pas pour rien
for (i in 1:nrow(Image_dispo_manitoba_nord))
{
  for (j in 1:nrow(Ont))
  {
    if(as.character(Image_dispo_manitoba_nord$Date[i]) == Ont$Date.Heure[j])
    {
      Image_journee_chaude_manitoba_nord <- rbind(Image_journee_chaude_manitoba_nord, Image_dispo_manitoba_nord[i,])
    }
  }
  print(i)
}

Image_journee_chaude_manitoba_nord <- Image_journee_chaude_manitoba_nord[-1,]
write.csv(Image_journee_chaude_manitoba_nord, "CHEMIN_FICHIER_CONTENANT_LES_INFORMATIONS_NÉCESSAIRES_AU_TÉLÉCHARGEMENT")
```

#Saskatchewan
```{r eval=FALSE}
region_sask <- ee$Geometry$BBox(-110.20, 48.94, -101.81, 53.74)
image_sask_2018 <- ee$ImageCollection("LANDSAT/LC08/C02/T1")$filterDate('2018-05-01', '2018-08-31')$filterBounds(region_sask)
image_sask_2019 <- ee$ImageCollection("LANDSAT/LC08/C02/T1")$filterDate('2019-05-01', '2019-08-31')$filterBounds(region_sask)
image_sask_2020 <- ee$ImageCollection("LANDSAT/LC08/C02/T1")$filterDate('2020-05-01', '2020-08-31')$filterBounds(region_sask)

image_sask_2018 <- image_sask_2018$getInfo()
image_sask_2018_df <- data.frame(1, c(1:length(image_sask_2018$features)))
image_sask_2018_df$Date <- 1
image_sask_2018_df$Row <- 1
image_sask_2018_df$Path <- 1

image_sask_2019 <- image_sask_2019$getInfo()
image_sask_2019_df <- data.frame(1, c(1:length(image_sask_2019$features)))
image_sask_2019_df$Date <- 1
image_sask_2019_df$Row <- 1
image_sask_2019_df$Path <- 1

image_sask_2020 <- image_sask_2020$getInfo()
image_sask_2020_df <- data.frame(1, c(1:length(image_sask_2020$features)))
image_sask_2020_df$Date <- 1
image_sask_2020_df$Row <- 1
image_sask_2020_df$Path <- 1

for (i in 1:length(image_sask_2018$features))
{
  image_sask_2018_df$Date[i] <- image_sask_2018$features[i][[1]]$properties$DATE_ACQUIRED
  image_sask_2018_df$Row[i] <- image_sask_2018$features[i][[1]]$properties$TARGET_WRS_ROW
  image_sask_2018_df$Path[i] <- image_sask_2018$features[i][[1]]$properties$TARGET_WRS_PATH
}

for (i in 1:length(image_sask_2019$features))
{
  image_sask_2019_df$Date[i] <- image_sask_2019$features[i][[1]]$properties$DATE_ACQUIRED
  image_sask_2019_df$Row[i] <- image_sask_2019$features[i][[1]]$properties$TARGET_WRS_ROW
  image_sask_2019_df$Path[i] <- image_sask_2019$features[i][[1]]$properties$TARGET_WRS_PATH
}

for (i in 1:length(image_sask_2020$features))
{
  image_sask_2020_df$Date[i] <- image_sask_2020$features[i][[1]]$properties$DATE_ACQUIRED
  image_sask_2020_df$Row[i] <- image_sask_2020$features[i][[1]]$properties$TARGET_WRS_ROW
  image_sask_2020_df$Path[i] <- image_sask_2020$features[i][[1]]$properties$TARGET_WRS_PATH
}

image_sask_2018_df <- extraction_date(image_sask_2018_df)
image_sask_2019_df <- extraction_date(image_sask_2019_df)
image_sask_2020_df <- extraction_date(image_sask_2020_df)

image_sask_2018_df <- image_sask_2018_df[,c(-1:-2)]
image_sask_2019_df <- image_sask_2019_df[,c(-1:-2)]
image_sask_2020_df <- image_sask_2020_df[,c(-1:-2)]

#combine les fichiers ensemble
Image_dispo_sask <- do.call('rbind', list(image_sask_2018_df,image_sask_2019_df,image_sask_2020_df))
Image_journee_chaude_sask <- Image_dispo_sask[1,]

#va cherche le fichier qui est les journees chaudes, soit 30 celsius ou plus comme t maximal dans la journee
donnee_meteo <- read.csv2("FICHIER_JOURNÉES_CHAUDES", sep=",")
donnee_station <- read.csv2("CHEMIN_DU_FICHIER\\Station Inventory EN_2.csv", sep = ",")
donnee_meteo_2 <- merge(donnee_meteo, donnee_station, by.x = "ID.climatologique", by.y = "Climate.ID")
Ont <- donnee_meteo_2[which(donnee_meteo_2$Province == "SASKATCHEWAN"),]

#Dans le lot d'images, pas toutes les images correspondent a des journees chaudes, donc on ne les telecharges pas pour rien
for (i in 1:nrow(Image_dispo_sask))
{
  for (j in 1:nrow(Ont))
  {
    if(as.character(Image_dispo_sask$Date[i]) == Ont$Date.Heure[j])
    {
      Image_journee_chaude_sask <- rbind(Image_journee_chaude_sask, Image_dispo_sask[i,])
    }
  }
  print(i)
}

Image_journee_chaude_sask <- Image_journee_chaude_sask[-1,]
write.csv(Image_journee_chaude_sask, "CHEMIN_FICHIER_CONTENANT_LES_INFORMATIONS_NÉCESSAIRES_AU_TÉLÉCHARGEMENT")
```





